<!DOCTYPE html><html lang="zh-Hant-TW"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=0"><title>將Webpack套用至現存的專案 | Intertidal</title><meta property="og:site_name" content="將Webpack套用至現存的專案 | Intertidal"><meta property="og:title" content="將Webpack套用至現存的專案 | Intertidal"><meta property="og:url" content="https://janelin612.github.io/2020/06/30/webpack-from-exist-project/"><meta name="description" content="
網路上有不少手把手一步一步把Webpack專案建構起來的教學，但如果你是想要把手邊亂七八糟的專案導入 Webpack "><meta property="og:description" name="twitter:description" content="
網路上有不少手把手一步一步把Webpack專案建構起來的教學，但如果你是想要把手邊亂七八糟的專案導入 Webpack "><meta property="og:image" name="twitter:image" content="https://janelin612.github.io/static/2020/2020-06-30_184850.jpg"><meta name="twitter:card" content="summary_large_image"><meta property="og:type" content="article"><link rel="canonical" href="https://janelin612.github.io/2020/06/30/webpack-from-exist-project/"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/apple-touch-icon-144-precomposed.png"><link rel="shortcut icon" href="/static/favicon.ico"><link rel="stylesheet" type="text/css" href="/styles/screen.css"><link rel="stylesheet" type="text/css" href="/styles/highlight.css"><link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml"><style>@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&display=swap') </style><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5K473GZ');
ga('create','');ga('send','pageview');</script><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="https://schema.org/WebPage"><noscript> <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5K473GZ" frameborder="0" style="display:none;visibility:hidden">      </iframe></noscript><header itemscope itemtype="https://schema.org/WPHeader"><h1 class="title"><a href="/" alt="Intertidal" title="Intertidal" itemprop="headline">Intertidal</a></h1><h2 class="subtitle"> 潮間帶工作室</h2><p itemprop="description"></p><nav itemscope itemtype="https://schema.org/SiteNavigationElement"><ul><li itemprop="name"><a href="/about" alt="About Me" title="About Me" itemprop="url">About Me</a></li><li itemprop="name"><a href="/archive" alt="Archive" title="Archive" itemprop="url">Archive</a></li><li class="icon-list"> <a href="/atom.xml"> <img src="/static/icon/rss-feed-tag.svg" alt="" srcset=""></a><a target="_blank" rel="noopener" href="https://github.com/janelin612"> <img src="/static/icon/github-circle.svg" alt="" srcset=""></a><a href="mailto:janelin612@gmail.com"> <img src="/static/icon/mail.svg" alt="" srcset=""></a></li></ul></nav><div class="space"></div></header><main itemscope itemtype="https://schema.org/Blog"><div class="content"><article class="full"><h1 itemprop="headline">將Webpack套用至現存的專案</h1><span class="post-meta"><time itemprop="datePublished" datetime="2020-06-29T16:00:00.000Z">2020-06-30</time></span><p><img src="/static/2020/2020-06-30_184850.jpg"></p>
<p>網路上有不少手把手一步一步把<a target="_blank" rel="noopener" href="https://webpack.js.org/">Webpack</a>專案建構起來的教學，但如果你是想要把手邊亂七八糟的專案導入 Webpack 呢？</p>
<span id="more"></span>

<h2 id="0-前言"><a href="#0-前言" class="headerlink" title="0. 前言"></a>0. 前言</h2><p>webpack 有不少雷來自於版本的差異，如果你上網估狗做法之後剪剪貼貼，很有可能會因為版本更新了而無法使用。所以這件事情寫在最前面，以下分享的內容基於<code>webpack 4.43.0</code> ，並預設您已裝好<code>node.js</code>以及<code>npm</code>，且具備基礎知識。</p>
<h3 id="為什麼我要導入-Webpack"><a href="#為什麼我要導入-Webpack" class="headerlink" title="為什麼我要導入 Webpack"></a>為什麼我要導入 Webpack</h3><p>簡單提一下我的原始專案，他是一隻單一一個 html 檔的專案，不過他有好幾隻的 js 檔，為了對應不同的業務需求有時候要載入<code>a.js</code>、<code>b.js</code>，有時候卻載入<code>a.js</code>跟<code>c.js</code>，每次版本切換就要把某幾行註解掉，另外幾行取消註解，html 檔本身也有幾行要修改，久了就覺得我應該要用工具做掉這件事情，於是找上了 Webpack。</p>
<p>如果你是為了類似的需求才找到這篇文章，那應該會有點幫助。</p>
<h2 id="1-開新專案"><a href="#1-開新專案" class="headerlink" title="1. 開新專案"></a>1. 開新專案</h2><p>先開個新資料夾再慢慢把檔案搬進來吧。<br>開好之後 cd 進去，然後開始初始化</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm init</span><br><span class="line">$ npm i -D webpack webpack-cli</span><br></pre></td></tr></table></figure>

<p>然後在根目錄新增幾個資料夾，以下這些資料夾&amp;檔案命名都隨便，但有些命名習慣可以遵守，不吃虧。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./src/           //放程式碼</span><br><span class="line">./static/        //放靜態資源，例如不想被打包的library，或者圖片檔之類的</span><br><span class="line">./dist/          //放建置完成的結果(可以拿去部署)</span><br></pre></td></tr></table></figure>

<p>接著新增兩個檔案</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./index.js          //程式的進入點</span><br><span class="line">./webpack.conf.js   //webpack的設定檔</span><br></pre></td></tr></table></figure>

<p>然後將建置用的指令放到<code>package.json</code>裡</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --config webpack.conf.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>這樣，只要執行<code>npm run build</code>就會建置了 (但你現在執行會報錯就是，畢竟設定檔是空的)<br>所以來編輯一下<code>webpack.conf.js</code>吧</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./index.js&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;output.js&quot;</span>,</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;dist&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>這時候再建置一次，你的 dist 資料夾內就應該有個<code>output.js</code>檔，這樣就算是會動了。</p>
<h2 id="2-撰寫index-js"><a href="#2-撰寫index-js" class="headerlink" title="2. 撰寫index.js"></a>2. 撰寫<code>index.js</code></h2><p>整理一堆 js 檔成為一個樹狀結構是這邊主要要做的事情。<br>由於有點複雜，我們先講結論：</p>
<ol>
<li>梳理樹狀結構，找到相依樹的根當成<code>index.js</code></li>
<li>其他被依賴的<code>js</code>檔模組(<code>module</code>)化</li>
<li>掛載會直接被 html 呼叫的程式到全域變數</li>
</ol>
<h3 id="梳理結構"><a href="#梳理結構" class="headerlink" title="梳理結構"></a>梳理結構</h3><p>原始的 html 可能長這樣:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;a.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;b.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;c.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>你要自行梳理出例如<code>a</code>才是主程式，並依賴於<code>b</code>跟<code>c</code>這樣的關係<br>這樣的例子中，你就可以把<code>a.js</code>的內容移植到<code>index.js</code>內</p>
<p>於是現在變成這樣:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./index.js //原本的a.js</span><br><span class="line"></span><br><span class="line">./src/b.js</span><br><span class="line">./src/c.js</span><br></pre></td></tr></table></figure>

<h3 id="模組化"><a href="#模組化" class="headerlink" title="模組化"></a>模組化</h3><p>原本的<code>b.js</code>檔可能是扁平的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> A = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getA</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反正這樣掛載到 html 上可以直接呼叫<code>getA()</code>使用，但透過 webpack 注入的話其他模組是無法呼叫到這些方法與變數的，所以要使用關鍵字<code>export</code>對外部公開</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//依然無法被外部存取</span></span><br><span class="line"><span class="keyword">const</span> A = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//可以被外部存取</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getA</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>這時候可以在<code>index.js</code>透過以下方法使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getA &#125; <span class="keyword">from</span> <span class="string">&quot;./src/b.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getA</span>()); <span class="comment">//0</span></span><br></pre></td></tr></table></figure>

<h3 id="掛載全域變數"><a href="#掛載全域變數" class="headerlink" title="掛載全域變數"></a>掛載全域變數</h3><p>上述是模組的部分，但如果你的程式碼是會直接被 html 使用的呢？例如這樣</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">&quot;start(); return false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">start</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// do something...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>這時候你可以把方法掛載到全域變數解決問題</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">start</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// do something...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="3-設定插件"><a href="#3-設定插件" class="headerlink" title="3. 設定插件"></a>3. 設定插件</h2><p>搞定 javascript 的部分，那其他的檔案呢？</p>
<h3 id="使用HtmlWebpackPlugin導入-html"><a href="#使用HtmlWebpackPlugin導入-html" class="headerlink" title="使用HtmlWebpackPlugin導入 html"></a>使用<code>HtmlWebpackPlugin</code>導入 html</h3><p>首先要有一個概念是 webpack 是以打包 js 檔為主的工具，所以你要引入任何不是 js 檔的東西都要額外裝插件，這跟我們單純在寫網頁，是把各種東西引入到 html 檔內的思維不太一樣。</p>
<p>安裝</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D html-webpack-plugin</span><br></pre></td></tr></table></figure>

<p>然後在<code>webpack.conf.js</code>啟用插件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&quot;./index.js&quot;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&quot;output.js&quot;</span>,</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&quot;dist&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&quot;index.html&quot;</span>,</span><br><span class="line">      <span class="attr">template</span>: <span class="string">&quot;./src/template/index.html&quot;</span>,</span><br><span class="line">      <span class="attr">inject</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>其中<code>filename</code>是輸出時的檔案名稱，而<code>template</code>則是你的原始 html 檔。<br>別忘了把你的 html 檔要被動態載入的資源清乾淨，包括<code>js</code>跟<code>css</code>，所有動態載入的東西最後會被自動放到<code>body</code>末端，像這樣:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">&lt;!-- 這行不用自己寫 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;output.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>也就是說，不希望動態載入的東西請留在 html 內</p>
</blockquote>
<h3 id="使用CopyWebpackPlugin複製靜態資源"><a href="#使用CopyWebpackPlugin複製靜態資源" class="headerlink" title="使用CopyWebpackPlugin複製靜態資源"></a>使用<code>CopyWebpackPlugin</code>複製靜態資源</h3><p>前面提到不希望動態載入的東西要維持原狀，這些東西可以借助這個套件在建置的時候自動複製到<code>/dist</code>資料夾內</p>
<p>安裝</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D copy-webpack-plugin</span><br></pre></td></tr></table></figure>

<p>啟用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">CopyWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;copy-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//上半省略</span></span><br><span class="line"><span class="attr">plugins</span>: [</span><br><span class="line">   <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">     <span class="attr">filename</span>: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">     <span class="attr">template</span>: <span class="string">&#x27;./src/template/index.html&#x27;</span>,</span><br><span class="line">     <span class="attr">inject</span>: <span class="literal">true</span></span><br><span class="line">   &#125;),</span><br><span class="line">   <span class="keyword">new</span> <span class="title class_">CopyWebpackPlugin</span>(&#123;</span><br><span class="line">      <span class="attr">patterns</span>: [</span><br><span class="line">        &#123; <span class="attr">from</span>: <span class="string">&#x27;./static&#x27;</span>, <span class="attr">to</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>) &#125;</span><br><span class="line">      ],</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br></pre></td></tr></table></figure>

<p>參數應該很好懂，從<code>./static</code>複製到<code>./dist</code></p>
<h3 id="使用SCSS"><a href="#使用SCSS" class="headerlink" title="使用SCSS"></a>使用<code>SCSS</code></h3><p>這年頭應該沒有人直接寫 css 檔吧？<del>地圖砲</del></p>
<p>安裝相依</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm i -D node-sass sass-loader style-loader</span><br></pre></td></tr></table></figure>

<p>啟用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="comment">//前面同上省略</span></span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        <span class="attr">use</span>: [</span><br><span class="line">          &#123; <span class="attr">loader</span>: <span class="string">&quot;style-loader&quot;</span> &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">loader</span>: <span class="string">&quot;css-loader&quot;</span>,</span><br><span class="line">            <span class="attr">options</span>: &#123; <span class="attr">modules</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123; <span class="attr">loader</span>: <span class="string">&quot;sass-loader&quot;</span> &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.s[ac]ss$/i</span>,</span><br><span class="line">        <span class="attr">use</span>: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;sass-loader&quot;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>就這樣，然後就可以直接在<code>index.js</code>引入你的<code>scss</code>檔了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;./src/style.scss&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="4-其他可以考慮設定的東西"><a href="#4-其他可以考慮設定的東西" class="headerlink" title="4. 其他可以考慮設定的東西"></a>4. 其他可以考慮設定的東西</h2><h3 id="路徑別名"><a href="#路徑別名" class="headerlink" title="路徑別名"></a>路徑別名</h3><p>可以隨便指定一個符號當成根目錄，這樣可以解決惱人的相對路徑問題</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">extensions</span>: [<span class="string">&quot;.js&quot;</span>, <span class="string">&quot;.json&quot;</span>],</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&quot;@&quot;</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;/src&quot;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="程式碼壓縮"><a href="#程式碼壓縮" class="headerlink" title="程式碼壓縮"></a>程式碼壓縮</h3><p>網路上可能會查到<code>UglifyJsPlugin</code>之類的工具，但這東西已經被 webpack 棄用了，要改用以下方法：</p>
<p>安裝</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$  npm i -D  terser-webpack-plugin</span><br></pre></td></tr></table></figure>

<p>設定</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">TerserPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;terser-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">optimization</span>: &#123;</span><br><span class="line">    <span class="attr">minimize</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">minimizer</span>: [<span class="keyword">new</span> <span class="title class_">TerserPlugin</span>()],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>詳細設定: <a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/terser-webpack-plugin/">TerserWebpackPlugin</a></p>
</blockquote>
<h3 id="開發用伺服器dev-server"><a href="#開發用伺服器dev-server" class="headerlink" title="開發用伺服器dev-server"></a>開發用伺服器<code>dev-server</code></h3><p>如果你不想改一行就要 build 一次，你會需要這東西</p>
<p>安裝</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$  npm i -D  webpack-dev-server</span><br></pre></td></tr></table></figure>

<p>然後將的指令放到<code>package.json</code>裡</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack --config webpack.conf.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack-dev-server --inline --progress --config webpack.conf.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>這樣就可以透過<code>npm run dev</code>開啟一個開發用伺服器預覽效果，並支援 hot reload</p>
<h2 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h2><p>上面做了一大堆，其實我的原始需求: 根據業務需求自動載入我需要的某幾隻程式都還沒做 XD<br>這我最後是透過分別寫兩個<code>webpack.conf.js</code>檔並分開建置完成的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ webpack --config webpack.a.conf.js</span><br><span class="line">$ webpack --config webpack.b.conf.js</span><br></pre></td></tr></table></figure>

<p>過去寫過好幾個用<code>vue-cli</code>建立起來的專案，雖然知道其是建立在 webpack 的基礎上完成，但實際從頭開一個 webpack 的專案才知道原來這麼多東西要設定…</p>
<p>因為我自己也還在一邊寫一邊學，以上內容如果有錯歡迎告知一下，謝謝:D</p>
</article><hr><div class="bmc-block"> <div class="bmc-greeting">Hi 喜歡這篇文章的話 可以按個讚或請我喝杯咖啡</div><style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#000000 !important;background-color:#FFDD00 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 22px !important;letter-spacing: 0.6px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/janelin612"><img src="https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span></a></div><iframe src="https://button.like.co/in/embed/janelin612/button?referrer=https%3A%2F%2Fjanelin612.github.io%2F2020%2F06%2F30%2Fwebpack-from-exist-project%2F" frameborder="0"> </iframe><hr><div class="related-posts"><div> <small> Previous: </small><div> <a href="/2020/07/03/about-n46-crawler/">如何備份乃木坂畢業成員部落格</a></div></div><div> <small> Next: </small><div><a href="/2020/02/22/kobo-libra-h2o/">Kobo Libra H2O 初步使用心得</a></div></div></div></div></main></body></html>